<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
  <meta http-equiv="Content-Security-Policy" content="default-src 'self' data: https://ssl.gstatic.com 'unsafe-eval' 'unsafe-inline'; style-src 'self' 'unsafe-inline'; media-src *; img-src 'self' data: content:;">
  <title>REL-ID MTD Tutorial</title>
  <link rel="stylesheet" type="text/css" href="css/index.css">
</head>
<body>
  <!-- ========== PERSISTENT SHELL (never destroyed during navigation) ========== -->

  <!-- MTD Modal Overlay (always in DOM, visibility toggled) -->
  <div id="mtd-modal-overlay" class="modal-overlay" style="display: none;">
    <div id="mtd-modal-container" class="modal-container">
      <!-- Modal Header -->
      <div class="modal-header">
        <h2 id="modal-title" class="modal-title"></h2>
        <p id="modal-subtitle" class="modal-subtitle"></p>
      </div>

      <!-- Threats Container -->
      <div class="threats-container">
        <div id="threats-header" class="threats-header"></div>
        <div id="threats-list" class="threats-list"></div>
      </div>

      <!-- Action Buttons -->
      <div id="modal-buttons" class="modal-buttons-container"></div>
    </div>
  </div>

  <!-- Main Content Container (dynamic content loaded here) -->
  <div id="app-content">
    <!-- Screen templates loaded here dynamically via NavigationService -->
  </div>

  <!-- ========== SCREEN TEMPLATES (hidden, loaded on demand) ========== -->

  <!-- Tutorial Home Screen Template -->
  <template id="TutorialHome-template">
    <div class="screen-container">
      <!-- Header -->
      <div class="header">
        <h1 class="title">REL-ID MTD Tutorial</h1>
        <p class="subtitle">Learn Mobile Threat Detection Integration</p>
      </div>

      <!-- SDK Info Card -->
      <div class="card">
        <h2 class="card-title">SDK Information</h2>
        <div class="info-row">
          <span class="info-label">SDK Version:</span>
          <span id="sdk-version" class="info-value">Loading...</span>
        </div>
        <div class="info-row">
          <span class="info-label">Platform:</span>
          <span class="info-value">Cordova</span>
        </div>
      </div>

      <!-- Tutorial Steps -->
      <div class="card">
        <h2 class="card-title">Tutorial Steps</h2>
        <div class="step-container">
          <div class="step">
            <div class="step-number">1</div>
            <p class="step-text">Click "Initialize" to start SDK initialization</p>
          </div>
          <div class="step">
            <div class="step-number">2</div>
            <p class="step-text">Watch real-time initialization progress</p>
          </div>
          <div class="step">
            <div class="step-number">3</div>
            <p class="step-text">MTD will check for security threats</p>
          </div>
          <div class="step">
            <div class="step-number">4</div>
            <p class="step-text">View results on completion</p>
          </div>
        </div>
      </div>

      <!-- Initialize Button -->
      <div class="button-container">
        <button id="initialize-btn" class="initialize-button">Initialize</button>
      </div>

      <!-- Progress Container -->
      <div id="progress-container" class="progress-container" style="display: none;">
        <p id="progress-text" class="progress-text">RDNA initialization in progress...</p>
      </div>

      <!-- Footer -->
      <div class="footer">
        <p class="footer-text">
          This tutorial demonstrates REL-ID SDK initialization with Mobile Threat Detection (MTD)
        </p>
      </div>
    </div>
  </template>

  <!-- Tutorial Success Screen Template -->
  <template id="TutorialSuccess-template">
    <div class="screen-container">
      <!-- Success Header -->
      <div class="header success-header">
        <div class="success-icon">‚úì</div>
        <h1 class="title">Initialization Successful</h1>
        <p class="subtitle">SDK initialized with active session</p>
      </div>

      <!-- Session Details Card -->
      <div class="card">
        <h2 class="card-title">Session Details</h2>

        <div class="info-row">
          <span class="info-label">Status Code:</span>
          <span id="status-code" class="info-value status-success">-</span>
        </div>

        <div class="info-row">
          <span class="info-label">Session Type:</span>
          <span id="session-type" class="info-value">-</span>
        </div>

        <div class="info-row">
          <span class="info-label">Session ID:</span>
          <span id="session-id" class="info-value session-id">-</span>
        </div>
      </div>

      <!-- Info Card -->
      <div class="card info-card">
        <h3 class="info-card-title">‚úì Security Checks Passed</h3>
        <p class="info-card-text">
          No security threats detected. The SDK has successfully initialized and
          established a secure session with the server.
        </p>
      </div>

      <!-- Footer -->
      <div class="footer">
        <p class="footer-text">
          Your session is now active and secure
        </p>
      </div>
    </div>
  </template>

  <!-- Tutorial Error Screen Template -->
  <template id="TutorialError-template">
    <div class="screen-container">
      <!-- Error Header -->
      <div class="header error-header">
        <div class="error-icon">‚úï</div>
        <h1 class="title">Initialization Failed</h1>
        <p class="subtitle">An error occurred during SDK initialization</p>
      </div>

      <!-- Error Details Card -->
      <div class="card">
        <h2 class="card-title">Error Details</h2>

        <div class="error-section">
          <h3 class="error-section-title">Description:</h3>
          <p id="error-description" class="error-description">-</p>
        </div>

        <div class="error-section">
          <h3 class="error-section-title">Error Codes:</h3>
          <div class="info-row">
            <span class="info-label">Short Code:</span>
            <span id="short-error-code" class="info-value error-code">-</span>
          </div>
          <div class="info-row">
            <span class="info-label">Long Code:</span>
            <span id="long-error-code" class="info-value error-code">-</span>
          </div>
        </div>
      </div>

      <!-- Troubleshooting Card -->
      <div class="card info-card error-info-card">
        <h3 class="info-card-title">Troubleshooting Tips</h3>
        <ul class="troubleshooting-list">
          <li>Check network connectivity</li>
          <li>Verify connection profile settings</li>
          <li>Check SDK logs for detailed error information</li>
          <li>Contact support if error persists</li>
        </ul>
      </div>

      <!-- Footer -->
      <div class="footer">
        <p class="footer-text">
          Please resolve the error and try again
        </p>
      </div>
    </div>
  </template>

  <!-- Security Exit Screen Template -->
  <template id="SecurityExit-template">
    <div class="screen-container security-exit-container">
      <div class="security-exit-content">
        <div class="security-icon-large">üîí</div>
        <h1 class="security-title">Security Protection Active</h1>
        <p class="security-message">
          A security threat was detected. For your protection, this application
          has been secured and must be manually closed.
        </p>

        <div id="exit-instructions" class="exit-instructions">
          <h2 class="instructions-title">How to close the app:</h2>
          <div class="instruction-item">‚Ä¢ Press the home button</div>
          <div class="instruction-item">‚Ä¢ Or swipe up from bottom (newer devices)</div>
          <div class="instruction-item">‚Ä¢ Or use the app switcher and swipe up on this app</div>
        </div>

        <div class="warning-box">
          <p class="warning-text">
            ‚ö†Ô∏è Do not reopen this app until the security issue is resolved.
          </p>
        </div>
      </div>
    </div>
  </template>

  <!-- ========== ALL SCRIPTS (loaded once, persist forever) ========== -->

  <!-- Cordova -->
  <script type="text/javascript" src="cordova.js"></script>

  <!-- Utilities -->
  <script type="text/javascript" src="src/uniken/utils/platformHelper.js"></script>
  <script type="text/javascript" src="src/uniken/utils/connectionProfileParser.js"></script>
  <script type="text/javascript" src="src/uniken/utils/progressHelper.js"></script>

  <!-- Services -->
  <script type="text/javascript" src="src/uniken/services/rdnaService.js"></script>
  <script type="text/javascript" src="src/uniken/services/rdnaEventManager.js"></script>

  <!-- MTD Components -->
  <script type="text/javascript" src="src/uniken/components/modals/ThreatDetectionModal.js"></script>
  <script type="text/javascript" src="src/uniken/MTDContext/MTDThreatManager.js"></script>

  <!-- Providers -->
  <script type="text/javascript" src="src/uniken/providers/SDKEventProvider.js"></script>

  <!-- App Initializer (handles SDK handler registration) -->
  <script type="text/javascript" src="src/uniken/AppInitializer.js"></script>

  <!-- Navigation -->
  <script type="text/javascript" src="src/tutorial/navigation/NavigationService.js"></script>

  <!-- All Screen Scripts (loaded upfront in SPA) -->
  <script type="text/javascript" src="src/tutorial/screens/TutorialHomeScreen.js"></script>
  <script type="text/javascript" src="src/tutorial/screens/TutorialSuccessScreen.js"></script>
  <script type="text/javascript" src="src/tutorial/screens/TutorialErrorScreen.js"></script>
  <script type="text/javascript" src="src/tutorial/screens/SecurityExitScreen.js"></script>

  <!-- App Bootstrap (deviceready, calls AppInitializer ONCE) -->
  <script type="text/javascript" src="js/app.js"></script>
</body>
</html>
